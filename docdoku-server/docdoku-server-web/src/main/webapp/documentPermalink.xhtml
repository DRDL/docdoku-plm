<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
      xmlns:docdokuplm="http://docdokuplm.net/facelets">

<f:loadBundle var="i18nDocument" basename="com.docdoku.server.localization.document_permalink_resource"/>
<head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>
    <title>#{i18nDocument['title']}</title>
    <link rel="Shortcut Icon" type="image/ico" href="#{request.contextPath}/images/favicon.ico"/>
    <script type="text/javascript" src="#{request.contextPath}/js/switchPlayer.js"></script>
    <script type="text/javascript" src="#{request.contextPath}/js/swfobject/swfobject.js"></script>

    <link rel="stylesheet/less" type="text/css" href="#{request.contextPath}/less/perma-link/style.less"/>
    <script type="text/javascript" src="#{request.contextPath}/js/lib/less-1.3.3.min.js"></script>

    <script type="text/javascript" src="#{request.contextPath}/js/lib/jquery-1.8.2.min.js"></script>

    <script type="text/javascript">
        $(function () {
            if(location.hash){
                $("#header_left_menu a").css("backgroundColor", "transparent");
                $(".well:visible").hide();
                $(window.location.hash).show();
                ongletSelectionne();
            }

            $(window).bind('hashchange', function (e) {
                $(".well:visible").hide();
                $(window.location.hash).show();
                $("#header_left_menu a").css("backgroundColor", "transparent");
                ongletSelectionne();
            });

            function ongletSelectionne (){
                switch($(window.location.hash).attr('id'))
                {
                    case "general":
                        $(".g").css("backgroundColor", "#213251");
                        break;
                    case "iteration":
                        $(".i").css("backgroundColor", "#213251");
                        break;
                    case "attribute":
                        $(".a").css("backgroundColor", "#213251");
                        break;
                    case "file":
                        $(".f").css("backgroundColor", "#213251");
                        break;
                    case "link":
                        $(".l").css("backgroundColor", "#213251");
                        break;
                    default:
                        $("#header_left_menu").css("backgroundColor", "transparent");
                }
            }
        });
    </script>
</head>

<body>
<div id="header" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="nav-collapse collapse">
            <div class="container-fluid">
                <img id="brand-logo" alt="docdoku_plm" src="/images/plm_logo2.png"/>
                <a class="brand" style="color: white">DocDoku<strong>PLM</strong>&nbsp;&nbsp;&nbsp;</a>
                <ul class="nav" id="header_left_menu">
                    <li><a style="color: white"><b>${docm}</b></a></li>
                    <li><a href="#general" style="color: white ; background-color: #213251" class="g">#{i18nDocument['section1.title']}</a></li>
                    <li><a href="#iteration" style="color: white" class="i">#{i18nDocument['section2.title']}</a></li>
                    <li><a href="#attribute" style="color: white" class="a">#{i18nDocument['section2.attributes']}</a></li>
                    <li><a href="#file" style="color: white" class="f">#{i18nDocument['sidebar.title1']}</a></li>
                    <li><a href="#link" style="color: white" class="l">#{i18nDocument['sidebar.title2']}</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div id="page">
    <div id="content">
        <div id="sidebar">

            <div id="file" class="well">
                <docdokuplm:scormViewer></docdokuplm:scormViewer>
            </div>

            <div id="link" class="well">
                <center><h3>#{i18nDocument['sidebar.title2']}</h3></center><br />
                <p>
                    <c:if test="${docm.lastIteration.linkedDocuments.size()!=0}">
                    <c:forEach var="item" items="${docm.lastIteration.linkedDocuments}">
                <li><a href="#{request.contextPath}/documents/${item.targetDocumentWorkspaceId}/${item.targetDocumentDocumentMasterId}/${item.targetDocumentDocumentMasterVersion}">${item.targetDocumentDocumentMasterId}-${item.targetDocumentDocumentMasterVersion}-${item.targetDocumentIteration}</a></li><br />
                </c:forEach>
                </c:if>
                <c:if test="${docm.lastIteration.linkedDocuments.size()==0}">
                    <div class="empty"><p>#{i18nDocument['section2.noLink']}</p></div>
                </c:if>
                </p>
            </div>
            <div id="attribute" class="well">
                <center><h3>#{i18nDocument['section2.attributes']}</h3></center><br />
                <p>
                    <c:if test="${attr.size()!=0}">
                <table class="table table-striped table-condensed">
                    <thead>
                    <tr>
                        <th>#{i18nDocument['section2.name']}</th>
                        <th>#{i18nDocument['section2.value']}</th>
                    </tr>
                    </thead>
                    <c:forEach var="item" items="${attr}">
                    <tbody>
                        <tr>
                            <td>${item.name}</td>

                            <c:choose>
                                <c:when test="${item.value.class=='class java.lang.Boolean'}">
                                    <c:if test="${item.value=='true'}">
                                        <td><input type="checkbox" checked="checked" disabled="disabled" /></td>
                                    </c:if>
                                    <c:if test="${item.value=='false'}">
                                        <td><input type="checkbox" disabled="disabled" /></td>
                                    </c:if>
                                </c:when>
                                <c:when test="${item.value.class=='class java.util.Date'}">
                                    <td><fmt:formatDate value="${item.value}" pattern="dd/MM/yyyy"/></td>
                                </c:when>
                                <c:when test="${item.class=='class com.docdoku.core.meta.InstanceURLAttribute'}">
                                    <td><a target="blank" href="${item.value}">${item.value}</a></td>
                                </c:when>
                                <c:otherwise>
                                    <td>${item.value}</td>
                                </c:otherwise>
                            </c:choose>
                        </tr>
                    </tbody>
                    </c:forEach>
                </table>
                </c:if>
                <c:if test="${attr.size()==0}">
                    <div class="empty"><p>#{i18nDocument['section2.noAttribute']}</p></div>
                </c:if>
                </p>
            </div>
        </div>
    </div>
    <div id="main">
        <div id="general" class="well" style="display: block">
            <center><h3>#{i18nDocument['section1.title']}</h3></center><br />
            <table class="table table-striped table-condensed">
                <tbody>
                <tr>
                    <th scope="row">#{i18nDocument['section1.author']}:</th>
                    <td>${docm.author.name}</td>
                </tr>
                <tr>
                    <th scope="row">#{i18nDocument['section1.date']}:</th>
                    <td><fmt:formatDate type="both" value="${docm.creationDate}"/></td>
                </tr>
                <tr>
                    <th scope="row">#{i18nDocument['section1.type']}:</th>
                    <td>${docm.type}</td>
                </tr>
                <tr>
                    <th scope="row">#{i18nDocument['section1.titledoc']}:</th>
                    <td>${docm.title}</td>
                </tr>
                <tr>
                    <th scope="row">#{i18nDocument['section1.checkout_user']}:</th>
                    <td>${docm.checkOutUser.name}</td>
                </tr>
                <tr>
                    <th scope="row">#{i18nDocument['section1.checkout_date']}:</th>
                    <td><fmt:formatDate type="both" value="${docm.checkOutDate}"/></td>
                </tr>
                <tr>
                    <th scope="row">#{i18nDocument['section1.state']}:</th>
                    <td>${docm.lifeCycleState}</td>
                </tr>
                <tr>
                    <th scope="row">#{i18nDocument['section1.tag']}:</th>
                    <td>${docm.tags}</td>
                </tr>
                <c:if test="${docm.description!=''}">
                    <tr>
                        <th scope="row">#{i18nDocument['section1.description']}:</th><td></td>
                    </tr>
                    <tr>
                        <td></td><td></td>
                    </tr>
                </c:if>
                </tbody>
            </table>
            <c:if test="${docm.description!=''}">
                <textarea name="" rows="5" cols="135" readonly="readonly" style="width: 100%">${docm.description}</textarea>
            </c:if>
        </div>
    </div>
    <div id="iteration" class="well">
        <center><h3>#{i18nDocument['section2.title']}</h3></center><br />
        <table>
            <tbody>
            <tr>
                <th scope="row">#{i18nDocument['section2.iteration']}:</th>
                <td>${docm.lastIteration.iteration}</td>
            </tr>
            <tr>
                <th scope="row">#{i18nDocument['section2.author']}:</th>
                <td>${docm.lastIteration.author.name}</td>
            </tr>
            <tr>
                <th scope="row">#{i18nDocument['section2.date']}:</th>
                <td><fmt:formatDate type="both" value="${docm.lastIteration.creationDate}"/></td>
            </tr>
            <tr>
                <th scope="row">#{i18nDocument['section2.revisionNote']}:</th>
                <td>${docm.lastIteration.revisionNote}</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>